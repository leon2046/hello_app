<%- model_class = OrderDetail -%>
<div class="page-header">
  <h2><%=t '.title', :default => model_class.model_name.human.pluralize.titleize %></h2>
</div>

<%= form_for :search, url: search_order_details_path, :html => { :class => "form-horizontal order" } do |f| %>
  <div class="col-xs-12 " style="padding:5px;">
  <div class="form-group">
    <div class="col-xs-12">
      <div class="input-group">
        <span class="input-group-addon"><%= (t '.order') %></span>
        <%= f.collection_select :order_id, Order.select_options, :id, :note, {:selected =>@params && @params["order_id"], :include_blank => (t '.prompt')}, {:class => 'form-control'}%>
        <span class="input-group-addon">
          <span class="glyphicon glyphicon-remove-circle"></span>
        </span>
      </div>
    </div>
    <%=f.error_span(:order_id) %>
  </div>

  <div class="form-group">
    <div class="col-xs-12">
      <div class="input-group">
        <span class="input-group-addon"><%= (t '.status') %></span>
        <%= f.select :order_status, OrderDetail.order_statuses.keys.to_a.map { |s| [t("activerecord.enums.order_detail.order_status.#{s}"), s]} , {:selected =>@params && @params["order_status"], :include_blank => (t '.prompt')}, {:class => 'form-control'} %>
        <span class="input-group-addon">
          <span class="glyphicon glyphicon-remove-circle"></span>
        </span>
      </div>
    </div>
    <%=f.error_span(:order_status) %>
  </div>

  </div>
  <div class="col-xs-12" style="padding:5px;">
  <%= link_to t('.new', :default => t("helpers.links.new")), new_order_detail_path, :class => 'btn btn-primary' %>
  <%= f.submit t('.search'), :class => 'btn btn-primary' %>
  </div>
<% end %>

<% @order_details.each do |detail| %>
  <div class="col-xs-12 list-group-item" style="padding:5px;">
    <div class="col-xs-12" style="margin-bottom:5px;">
      <%= link_to order_path(detail.order_id) do%>
        <span class="label label-info"><%= t '.order'%>:<%= detail.order_id %></span>
      <% end %>
      <%= link_to order_detail_path(detail) do %>
        <span class="label label-info"><%= t '.order_detail'%>:<%= detail.id %></span>
      <% end %>
      <span class="label label-info"><%= detail.created_at.strftime("%Y/%m/%d") %></span>
    </div>
    <div class="col-xs-12">
      <p><%= detail.attributes["name_jp"] %></p>
      <p><%= detail.attributes["name_cn"] %></p>
    </div>
    <div class="col-xs-12">
      <p>
        <span class="label label-default"><%= t '.quantity'%>:<%= detail.quantity %></span>
        <span class="label label-default"><%= t '.selling_price'%>:<%= number_to_currency(detail.selling_price, :unit => "CNY") %></span>
        <span class="label label-danger"><%= t '.total_amount'%>:<%= number_to_currency(detail.total_amount, :unit => "CNY") %></span>
      </p>
    </div>
    <div class="col-xs-12">
      <p>
        <span class="label label-default"><%= t '.status'%>:<%= detail.order_status %></span>
        <span class="label label-info"><%= t '.note'%>:<%= detail.order_note %></span>
      </p>
    </div>
    <div class="col-xs-12">
      <%= link_to t('.edit', :default => t("helpers.links.edit")),
                edit_order_detail_path(detail), :class => 'btn btn-info btn-xs pull-right' %>
    </div>
  </div>
<% end %>
<%= javascript_include_tag "common/remomve_button_for_select" %>
