<%- model_class = Order -%>
<div class="page-header">
  <h2><%=t '.title', :default => model_class.model_name.human.pluralize.titleize %></h2>
</div>

  <div class="col-xs-12 " style="padding:5px;">
  <%= form_for :search, url: search_orders_path, :html => { :class => "form-horizontal order" } do |f| %>
  <div class="form-group">
    <div class="col-lg-12">
      <div class="input-group">
        <span class="input-group-addon"><%= (t '.customer') %></span>
        <%= f.collection_select :customer_id, Customer.all, :id, :name, {:prompt => (t '.prompt')}, {:class => 'form-control'}%>
      </div>
    </div>
    <%=f.error_span(:customer_id) %>
  </div>

  <div class="form-group">
    <div class="col-xs-12">
      <div class="input-group">
        <span class="input-group-addon"><%= (t '.status') %></span>
        <%= f.select :status, Order.statuses.keys.to_a.map { |s| [t("activerecord.enums.order.status.#{s}"), s]} , { :prompt => (t '.prompt')}, {:class => 'form-control'} %>
      </div>
    </div>
    <%=f.error_span(:status) %>
  </div>

  </div>
  <div class="col-lg-12" style="padding:5px;">
  <%= link_to t('.new', :default => t("helpers.links.new")),new_order_path, :class => 'btn btn-primary' %>
  <%= f.submit t('.search'), :class => 'btn btn-primary' %>
  </div>
<% end %>
  <hr/>

<% @orders.each do |order| %>
    <div class="col-xs-12 list-group-item" style="padding:5px;">
      <span class="badge"><%= order.created_at.strftime("%Y/%m/%d") %></span>
      <div class="col-xs-8">
        <%= link_to  order_path(order) do %>
        <p>
          <span class="label label-info">Order Id: <%= order.id %></span>
        </p>
        <% end %>
        <p>
          <span class="list-group-item-heading bg-warning">Status:</span>
          <span class="label label-default"><%= order.status %></span>
        </p>
        <p>
          <span class="label label-danger">Total: <%= order.orderDetails.sum(:total_amount).to_s(:delimited) %></span>
          <span class="label label-danger">Payment: <%= order.payments.sum(:amounts).to_s(:delimited) %></span>
        </p>
        <p class="list-group-item-heading bg-warning"><span class="label label-warning">Note:</span>
          <span><%= order.note %></span>
        </p>
      </div>
      <div class="col-xs-4">
        <span class="list-group-item-heading">
          Customer: <%= link_to order.attributes["customer_name"], customer_path(order.customer_id) %>
        </span>
      </div>
      <%= link_to t('.edit', :default => t("helpers.links.edit")),
                  edit_order_path(order), :class => 'btn btn-info btn-xs right-bttom' %>
    </div>
<% end %>
